import 'package:dartz/dartz.dart';
import '../../../../core/errors/failures.dart';
import '../entities/user_entity.dart';

/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
/// ๐ AuthRepository - ูุงุฌูุฉ Repository (Domain Layer)
/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
///
/// ุงููุฏู ูู ูุฐุง ุงูููู:
/// ูุฐุง abstract class ูุนุฑูู ุงูุนูุฏ (Contract) ุจูู Domain ู Data Layers
/// 
/// ูุง ูู Repositoryุ
/// Repository = ูุณูุท (ูููู) ุจูู Use Cases ู Data Sources
/// 
/// ุงูููุฑุฉ:
/// Use Case ูุง ูุนุฑู ูู ุฃูู ุชุฃุชู ุงูุจูุงูุงุช (Firebase ุฃู Hive ุฃู Mock)
/// Repository ูู ุงููุณูุท ุงูุฐู ูุชุนุงูู ูุน ูุฐุง
/// 
/// ุงููุจุฏุฃ:
/// **Dependency Inversion Principle**
/// ุจุฏูุงู ูู:
///   UseCase โ FirebaseAuthRemoteDataSource (ูุจุงุดุฑ = ุตุนุจ ุงูุงุฎุชุจุงุฑ)
/// ูุณุชุฎุฏู:
///   UseCase โ AuthRepository (ูุงุฌูุฉ) โ FirebaseAuthRemoteDataSource
/// 
/// ุงูููุงุฆุฏ:
/// โ ุณูููุฉ ุงูุงุฎุชุจุงุฑ: ูุณุชุจุฏู FirebaseAuth ุจู MockAuth
/// โ ุงููุฑููุฉ: ูููู ุชุบููุฑ ูุตุฏุฑ ุงูุจูุงูุงุช ุจุฏูู ุชุบููุฑ UseCase
/// โ ูุธุงูุฉ ุงูููุฏ: ูู ุทุจูุฉ ูุง ุชุนุฑู ุชูุงุตูู ุงูุทุจูุฉ ุงูุฃุฎุฑู
///
/// ุงูุชุณูุณู:
/// BLoC โ AuthBloc._onLoginRequested()
///   โ
/// LoginUseCase.call()
///   โ
/// AuthRepository.login() โ ูุฐุง ููู ุงูุขู
///   โ
/// AuthRepositoryImpl.login() โ ุงูุชุทุจูู (data layer)
///   โ
/// DataSources (Firebase / Hive)

abstract class AuthRepository {
  /// ๐ ุชุณุฌูู ุงูุฏุฎูู
  /// Parameters:
  ///   - email: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
  ///   - password: ูููุฉ ุงููุฑูุฑ
  /// 
  /// Return:
  ///   Either<Failure, UserEntity>
  ///   - Left (ูุดู): ุฑุณุงูุฉ ุฎุทุฃ
  ///   - Right (ูุฌุงุญ): ุจูุงูุงุช ุงููุณุชุฎุฏู
  /// 
  /// ุงุณุชุซูุงุกุงุช ูุญุชููุฉ:
  ///   - AuthFailure: ุจูุงูุงุช ุฎุงุทุฆุฉ
  ///   - UnknownFailure: ุฎุทุฃ ุบูุฑ ูุชููุน
  Future<Either<Failure, UserEntity>> login(String email, String password);
  
  /// ๐ ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ
  /// Parameters:
  ///   - name: ุงุณู ุงููุณุชุฎุฏู
  ///   - email: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู
  ///   - password: ูููุฉ ุงููุฑูุฑ (ูุฌุจ ุฃู ุชููู ูููุฉ)
  /// 
  /// Return:
  ///   Either<Failure, UserEntity>
  /// 
  /// ููุงุญุธุฉ:
  ///   - ูุฌุจ ุงูุชุญูู ูู ุนุฏู ูุฌูุฏ ูุฐุง ุงูุจุฑูุฏ ูุณุจูุงู
  ///   - ูุฌุจ ุฅุฑุณุงู ุฑุงุจุท ุงูุชุญูู ูู ุงูุจุฑูุฏ
  Future<Either<Failure, UserEntity>> register(
    String name,
    String email,
    String password,
  );
  
  /// ๐ช ุชุณุฌูู ุงูุฎุฑูุฌ
  /// ูุญุฐู:
  ///   - Token ูู ุงูุชุฎุฒูู ุงููุญูู
  ///   - ุจูุงูุงุช ุงููุณุชุฎุฏู ูู ุงูุฐุงูุฑุฉ
  ///   - ุฌูุณุฉ ุงููุณุชุฎุฏู ูู Firebase
  /// 
  /// Return:
  ///   Either<Failure, void> โ ูุง ูุญุชุงุฌ ุจูุงูุงุชุ ููุท ูุฌุงุญ/ูุดู
  Future<Either<Failure, void>> logout();
  
  /// ๐ ุฅุนุงุฏุฉ ุชุนููู ูููุฉ ุงููุฑูุฑ
  /// Parameters:
  ///   - email: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู ููุจุญุซ ุนูู
  /// 
  /// ุงูุนูููุฉ:
  ///   1. ุงูุจุญุซ ุนู ุงูุจุฑูุฏ ูู ูุงุนุฏุฉ ุงูุจูุงูุงุช
  ///   2. ุฅุฑุณุงู ุฑุงุจุท ุชุนููู ูููุฉ ุงููุฑูุฑ ููุจุฑูุฏ
  ///   3. ุงููุณุชุฎุฏู ูููุฑ ุนูู ุงูุฑุงุจุท
  ///   4. ูุนููู ูููุฉ ุงููุฑูุฑ ุงูุฌุฏูุฏุฉ
  /// 
  /// Return:
  ///   Either<Failure, void>
  Future<Either<Failure, void>> resetPassword(String email);
  
  /// ๐ค ุงูุญุตูู ุนูู ุจูุงูุงุช ุงููุณุชุฎุฏู ุงูุญุงูู
  /// 
  /// ุงูุณููุงุฑูููุงุช:
  ///   1. ููุงู Token ูู ุงูุชุฎุฒูู ุงููุญูู
  ///      โ ุชุญูู ูู ุตุญุชู ูู Firebase
  ///      โ ุฅุฑุฌุงุน ุจูุงูุงุช ุงููุณุชุฎุฏู
  ///   2. ูุง ููุฌุฏ Token
  ///      โ ุฅุฑุฌุงุน ูุดู
  /// 
  /// Return:
  ///   Either<Failure, UserEntity>
  Future<Either<Failure, UserEntity>> getCurrentUser();
  
  /// ๐ง ุฅุฑุณุงู ุฑุงุจุท ุงูุชุญูู ูู ุงูุจุฑูุฏ
  /// 
  /// ูุงุฐุง ูุญุฏุซุ
  ///   1. Firebase ูููุฏ ุฑุงุจุท ุงูุชุญูู
  ///   2. ููุฑุณู ุงูุจุฑูุฏ ูููุณุชุฎุฏู
  ///   3. ุงููุณุชุฎุฏู ูููุฑ ุนูู ุงูุฑุงุจุท
  ///   4. ุงูุจุฑูุฏ ุฃุตุจุญ "ููุซู"
  /// 
  /// Return:
  ///   Either<Failure, void>
  Future<Either<Failure, void>> sendEmailVerification();
  
  /// ๐ฑ ุงูุชุญูู ูู ุฑูู ุงููุงุชู (Optional)
  /// 
  /// ููุงุญุธุฉ: ุบูุฑ ูุทุจู ุญุงููุงู
  /// ูููู ุงุณุชุฎุฏุงูู ูุงุญูุงู (2FA = Two Factor Authentication)
  Future<Either<Failure, void>> verifyPhoneNumber(String phoneNumber);
  
  /// ๐ Stream: ูุฑุงูุจุฉ ุชุบูุฑุงุช ุญุงูุฉ ุงููุตุงุฏูุฉ
  /// 
  /// ุงูููุฑุฉ:
  ///   Firebase ูุฑุงูุจ ุญุงูุฉ ุงููุณุชุฎุฏู ุงูุญุงูู
  ///   ูู ูุฑุฉ ุชุชุบูุฑ โ Stream ุชูุตุฏุฑ null ุฃู UserEntity
  /// 
  /// ุงูุงุณุชุฎุฏุงู:
  ///   ```
  /// repository.authStateChanges.listen((user) {
  ///   if (user == null) {
  ///     // ุงููุณุชุฎุฏู ุณุฌู ุฎุฑูุฌ
  ///   } else {
  ///     // ุงููุณุชุฎุฏู ูุณุฌู ุฏุฎูู
  ///   }
  /// });
  ///   ```
  /// 
  /// ูุซุงู: ุงููุณุชุฎุฏู ุณุฌู ุฏุฎูู ูู ุฌูุงุฒ ุขุฎุฑ
  ///   โ ุงูุฌูุงุฒ ุงูุญุงูู ูุณุชูุจู ุงูุชุญุฏูุซ
  ///   โ ูููู ุชุญุฏูุซ ุงูู UI ุชููุงุฆูุงู
  Stream<UserEntity?> get authStateChanges;
}
