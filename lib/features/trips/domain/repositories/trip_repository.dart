import 'package:dartz/dartz.dart';
import '../../../../core/errors/failures.dart';
import '../entities/trip_entity.dart';
import '../entities/location_entity.dart';
import '../entities/deviation_entity.dart';

/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
/// ๐๏ธ TripRepository - ูุงุฌูุฉ ูุณุชูุฏุน ุงูุฑุญูุงุช (Domain Layer)
/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
///
/// โ ูุง ูู ุงูู Repository ูู ุทุจูุฉ ุงูู Domainุ
/// ุชุฎูู ุฃูู "ุนูุฏ ุนูู" ุฃู "ุฏุณุชูุฑ". ูู ูููู ููุชุทุจูู: "ุฃูุง ุฃุญุชุงุฌ ููุฐู ุงูุนูููุงุช 
/// ููู ูุนูู ูุธุงู ุงูุฑุญูุงุชุ ูุง ููููู ููู ุณุชููุฐูุง (ุณูุงุก ุจู Firebase ุฃู Hive)ุ 
/// ุงูููู ุฃู ุชููุฑ ูู ูุฐู ุงูุฏูุงู".
///
/// ๐ก ููุงุฐุง ูู Abstractุ
/// ููู ููุตู "ุงูุชุนุฑูู" ุนู "ุงูุชูููุฐ". ุงูู Domain ูุถุน ุงูููุงูููุ ูุงูู Data ุชููุฐูุง.
/// ูุฐุง ูู ุณุฑ ููุฉ ุงูู Clean Architectureุ ููููู ุงุฎุชุจุงุฑ ุงููุธุงู ูุงููุงู ุฏูู 
/// ุงูุญุงุฌุฉ ููุงุนุฏุฉ ุจูุงูุงุช ุญููููุฉ!
///
/// ๐ ุดุฑุญ ูููุจุชุฏุฆูู:
/// - Either<Failure, T>: ูู ุทุฑููุฉ ุฐููุฉ ูุฅุฎุจุงุฑ ุงูุจุฑูุฌุฉ ุฃู ุงูุฏุงูุฉ ูุฏ ุชูุดู.
///   - Left (ุงููุณุงุฑ): ูุนูู ุญุฏุซ ุฎุทุฃ (Failure).
///   - Right (ุงููููู): ูุนูู ูุฌุญุช ุงูุนูููุฉ ูุฑุฌุนุช ุงูุจูุงูุงุช (T).
abstract class TripRepository {
  
  /// ๐ ุจุฏุก ุฑุญูุฉ: ูุทูุจ ูู ุงููุธุงู ุฅูุดุงุก ุณุฌู ุฑุญูุฉ ุฌุฏูุฏ.
  Future<Either<Failure, TripEntity>> startTrip(
    String routeId,
    LocationEntity startLocation,
  );
  
  /// ๐ ุฅููุงุก ุฑุญูุฉ: ูุทูุจ ุฅุบูุงู ุงูุฑุญูุฉ ูุญุณุงุจ ุงููุชุงุฆุฌ ุงูููุงุฆูุฉ.
  Future<Either<Failure, TripEntity>> endTrip(
    String tripId,
    LocationEntity endLocation,
  );
  
  /// โธ๏ธ ุฅููุงู ูุคูุช: ููููุงูู ุงูุชู ูุญุชุงุฌ ูููุง ุงููุณุชุฎุฏู ููุชููู ุฏูู ุฅููุงุก ุงูุฑุญูุฉ.
  Future<Either<Failure, TripEntity>> pauseTrip(String tripId);
  
  /// โถ๏ธ ุงุณุชุฆูุงู: ุงูุนูุฏุฉ ูุชุชุจุน ุงูุฑุญูุฉ ุจุนุฏ ุงูุฅููุงู ุงููุคูุช.
  Future<Either<Failure, TripEntity>> resumeTrip(String tripId);
  
  /// โ ุฅูุบุงุก: ูุณุญ ุจูุงูุงุช ุงูุฑุญูุฉ ุงูุญุงููุฉ ููุฃููุง ูู ุชูู.
  Future<Either<Failure, void>> cancelTrip(String tripId);
  
  /// ๐ ุฌูุจ ุงูุฑุญูุฉ ุงููุดุทุฉ: ูู ุงููุณุชุฎุฏู ูู ูุณุท ุฑุญูุฉ ุงูุขูุ (ููู ุฌุฏุงู ุนูุฏ ูุชุญ ุงูุชุทุจูู).
  Future<Either<Failure, TripEntity?>> getActiveTrip(String userId);
  
  /// ๐ ุณุฌู ุงูุฑุญูุงุช: ุฌูุจ ูุงุฆูุฉ ุจูู ูุง ูุงู ุจู ุงููุณุชุฎุฏู ุณุงุจูุงู.
  Future<Either<Failure, List<TripEntity>>> getTripHistory(
    String userId, {
    int? limit,       // ุนุฏุฏ ุงูุฑุญูุงุช ุงููุทููุจุฉ (ูุซูุงู ุขุฎุฑ 10).
    DateTime? from,   // ุงูุจุญุซ ูู ุชุงุฑูุฎ ูุนูู.
    DateTime? to,     // ุงูุจุญุซ ุญุชู ุชุงุฑูุฎ ูุนูู.
  });
  
  /// ๐ ุชุญุฏูุซ ุงููููุน: ุฃูู ุฏุงูุฉ! ุชูุณุชุฏุนู ูู ุซุงููุฉ ูุชุณุฌูู ููุงู ุงููุณุชุฎุฏู ุงูุญุงูู.
  Future<Either<Failure, TripEntity>> updateTripLocation(
    String tripId,
    LocationEntity location,
  );
  
  /// โ๏ธ ุฅุถุงูุฉ ุงูุญุฑุงู: ุฅุฐุง ุงูุชุดู ุงููุธุงู ุฃู ุงููุณุชุฎุฏู ุฎุฑุฌ ุนู ุงูุทุฑููุ ูุณุฌู ุฐูู ููุง.
  Future<Either<Failure, void>> addDeviation(
    String tripId,
    DeviationEntity deviation,
  );
  
  /// ๐ ุจุซ ูุจุงุดุฑ (Stream): ุฏุงูุฉ ุชูุชุญ ููุงุฉ ุงุชุตุงู ูุณุชูุฑุฉ ูุชุฑุณู ุชุญุฏูุซุงุช ุงูุฑุญูุฉ 
  /// ููุฑ ุญุฏูุซูุง ูุชุญุฏูุซ ุงูุฎุฑูุทุฉ ุชููุงุฆูุงู.
  Stream<TripEntity> tripUpdates(String tripId);
}
