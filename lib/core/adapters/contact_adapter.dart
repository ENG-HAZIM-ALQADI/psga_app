import 'package:hive/hive.dart';
import '../../features/alerts/data/models/contact_model.dart';

/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
/// ๐ฅ ContactModelAdapter - ุงููุญููู ุงูุฎุงุต ุจุชุฎุฒูู ูุงุณุชุฑุฌุงุน ุฌูุงุช ุงูุงุชุตุงู ุงูุทุงุฑุฆุฉ
/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
/// 
/// ๐ฏ ุงููููุน ูู Clean Architecture:
/// - ุงูุทุจูุฉ: Core Layer > Adapters
/// - ุงููุธููุฉ: ุชุญููู ContactModel (ุฌูุฉ ุงุชุตุงู ุทูุงุฑุฆ) ูู/ุฅูู Binary
/// 
/// ๐ ูุง ูู Contact ูู ุชุทุจูู PSGAุ
/// Contact ูู "ุดุฎุต ููุซูู" ูููู ููุชุทุจูู ุงูุงุชุตุงู ุจู ูู ุญุงูุงุช ุงูุทูุงุฑุฆ:
/// - ุฃูุฑุงุฏ ุงูุนุงุฆูุฉ (ุฃุจุ ุฃูุ ุฃุฎุ ุฅูุฎ)
/// - ุฃุตุฏูุงุก ููุฑุจูู
/// - ุฒููุงุก ุนูู
/// - ุฎุฏูุงุช ุงูุทูุงุฑุฆ (ุงูุดุฑุทุฉุ ุงูุฅุณุนุงูุ ุฅูุฎ)
/// 
/// ๐ก ูุซุงู ูุงูุนู:
/// ุฃูุง ุฃุญูุฏุ ุฃุถูู ูุงูุฏู ูู Contact:
/// ```
/// Contact {
///   name: "ูุงูุฏู ูุญูุฏ",
///   phoneNumber: "+966501234567",
///   email: "dad@example.com",
///   relationship: "ูุงูุฏ",
///   isEmergencyContact: true,      โ ูู ุญุงูุฉ SOSุ ุงุชุตู ุจู!
///   priority: 1,                   โ ุงูุฃูู ูู ุงููุงุฆูุฉ
///   canViewLiveLocation: true,     โ ููุฏุฑ ูุดูู ูููุนู ุงูุญู
///   isVerified: true               โ ุชู ุงูุชุญูู ูู ุงูุฑูู
/// }
/// ```
/// 
/// ๐ข typeId = 6:
/// - ุฑูู ูุฑูุฏ ูู ContactModel ูู Hive
/// 
/// ๐ ุจููุฉ Contact:
/// - ูุนูููุงุช ุฃุณุงุณูุฉ: ุงูุงุณูุ ุงูุฑููุ ุงูุฅูููู
/// - ูุนูููุงุช ุงูุนูุงูุฉ: ููุน ุงูุนูุงูุฉุ ุงูุฃููููุฉ
/// - ุตูุงุญูุงุช: ูู ููุฏุฑ ูุดูู ุงููููุน ุงูุญูุ
/// - ุญุงูุฉ: ูู ุงูุฑูู ูุชุญูู ูููุ
/// - ุชูููุฉ: FCM Token ููุฅุดุนุงุฑุงุช
/// 
/// ๐จ ุฃูููุฉ Contact ูู ูุธุงู ุงูุฃูุงู:
/// ูู ุญุงูุฉ ุทูุงุฑุฆ (SOS)ุ ุงูุชุทุจูู ูุชุตู ุชููุงุฆูุงู ุจุฌููุน ุฌูุงุช ุงูุงุชุตุงู
/// ุญุณุจ ุงูุฃููููุฉ (priority)ุ ููุฑุณู ููู:
/// - ูููุน ุงููุณุชุฎุฏู ุงูุญุงูู
/// - ุชูุงุตูู ุงูุฑุญูุฉ
/// - ุฑุณุงูุฉ ุงูุงุณุชุบุงุซุฉ
/// - ุฑุงุจุท ูุชุชุจุน ุงููููุน ุงูุญู

class ContactModelAdapter extends TypeAdapter<ContactModel> {
  /// ๐ข typeId: ุฑูู ุงูุชุนุฑูู ุงููุฑูุฏ
  /// - 0 = UserModel
  /// - 1 = RouteModel
  /// - 2 = TripModel
  /// - 3 = WaypointModel
  /// - 4 = LocationModel
  /// - 5 = AlertModel
  /// - 6 = ContactModel โ (ุงุญูุง ููุง!)
  /// - 7-9 = Models ุฃุฎุฑู
  @override
  final int typeId = 6;

  /// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  /// ๐ read() - ูุฑุงุกุฉ ContactModel ูู Hive
  /// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  /// 
  /// ๐ฏ ูุชู ุชูุณุชุฏุนูุ
  /// - ุนูุฏ ูุชุญ ุตูุญุฉ "ุฌูุงุช ุงูุงุชุตุงู ุงูุทุงุฑุฆุฉ"
  /// - ุนูุฏ ุฅุฑุณุงู ุฅุดุนุงุฑ ุทูุงุฑุฆ (ูุญุชุงุฌ ูุฌูุจ ุฃุฑูุงู ุฌูุงุช ุงูุงุชุตุงู)
  /// - ุนูุฏ ุนุฑุถ ูู ููุฏุฑ ูุดูู ุงููููุน ุงูุญู
  /// - ุนูุฏ ุงูุชุญูู ูู ุตูุงุญูุงุช ุฌูุฉ ุงุชุตุงู ูุนููุฉ
  /// 
  /// ๐ ุงูุฎุทูุงุช:
  /// 1. ูุฑุงุกุฉ ุนุฏุฏ ุงูุญููู (12 ุญูู)
  /// 2. ุชุฌููุน ุงูุจูุงูุงุช ูู Map
  /// 3. ุฅูุดุงุก ContactModel ูุจุงุดุฑุฉ (ุจุฏูู fromJson)
  /// 
  /// โ๏ธ ููุงุญุธุฉ ูููุฉ:
  /// ุนูู ุนูุณ Adapters ุงูุณุงุจูุฉุ ููุง ููุดุฆ ContactModel ูุจุงุดุฑุฉ
  /// ุจุฏูุงู ูู ุงุณุชุฎุฏุงู fromJsonุ ูุฃู ุงูุจูุงูุงุช ุจุณูุทุฉ ูุณุจูุงู
  @override
  ContactModel read(BinaryReader reader) {
    /// 1๏ธโฃ ููุฑุฃ ุนุฏุฏ ุงูุญููู (12 ุญูู)
    final numOfFields = reader.readByte();
    
    /// 2๏ธโฃ ูุฌูุน ุงูุจูุงูุงุช ูู Map
    final fields = <int, dynamic>{
      for (int i = 0; i < numOfFields; i++) reader.readByte(): reader.read(),
    };

    /// 3๏ธโฃ ูููุดุฆ ContactModel ูุจุงุดุฑุฉ
    /// 
    /// ๐ ุดุฑุญ ูู ุญูู ุจุงูุชูุตูู:
    return ContactModel(
      /// Field 0: ูุนุฑูู ุฌูุฉ ุงูุงุชุตุงู
      /// - ูุฑูุฏ ููู Contact
      /// - ูุซุงู: "contact_dad_123"
      id: fields[0] as String,
      
      /// Field 1: ูุนุฑูู ุงููุณุชุฎุฏู ุตุงุญุจ ุฌูุฉ ุงูุงุชุตุงู
      /// - ูู ุงูุฐู ุฃุถุงู ูุฐู ุงูุฌูุฉุ
      /// - ูุฑุจุท Contact ุจู User
      userId: fields[1] as String,
      
      /// Field 2: ุงุณู ุฌูุฉ ุงูุงุชุตุงู
      /// - ุงูุงุณู ุงููุงูู ุฃู ุงูุงุณู ุงููุณุชุนุงุฑ
      /// - ุฃูุซูุฉ:
      ///   * "ูุงูุฏู ูุญูุฏ"
      ///   * "ุฃุฎู ุณุนูุฏ"
      ///   * "ุตุฏููู ุนุจุฏุงููู"
      ///   * "ุดุฑุทุฉ ุงููุฌุฏุฉ"
      /// 
      /// ๐ก ูุตูุญุฉ:
      /// ุดุฌุน ุงููุณุชุฎุฏู ุนูู ูุชุงุจุฉ ุงุณู ูุงุถุญ ููููุฒ
      /// ุจุฏูุงู ูู "ุฃุจู" ุฃู "Friend 1"
      name: fields[2] as String,
      
      /// Field 3: ุฑูู ุงููุงุชู
      /// - ุจุตูุบุฉ ุฏูููุฉ (ูุน ููุฏ ุงูุฏููุฉ)
      /// - ูุซุงู: "+966501234567"
      /// 
      /// โ๏ธ ููู ุฌุฏุงู:
      /// - ูุฌุจ ุฃู ูููู ุงูุฑูู ุตุญูุญ 100%
      /// - ูู ุญุงูุฉ SOSุ ุญูุงุฉ ูุฏ ุชุนุชูุฏ ุนูู ูุฐุง ุงูุฑูู!
      /// - ูุณุชุฎุฏูู ููุงุชุตุงู ุงููุงุชูู ูุงูู SMS
      phoneNumber: fields[3] as String,
      
      /// Field 4: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ุงุฎุชูุงุฑู)
      /// - ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช ุนุจุฑ Email
      /// - ูููุฏ ุฅุฐุง ูุงู ุงูุดุฎุต ูุง ูุณุชุฎุฏู ุงูุชุทุจูู
      /// - ูููู ุฃู ูููู null
      email: fields[4] as String?,
      
      /// Field 5: FCM Token (ุงุฎุชูุงุฑู)
      /// - ุฑูุฒ Firebase Cloud Messaging
      /// - ูุฅุฑุณุงู ุฅุดุนุงุฑุงุช Push ูุจุงุดุฑุฉ
      /// - ููุฌูุฏ ููุท ุฅุฐุง ูุงู ุงูุดุฎุต ูุณุชุฎุฏู ููุณ ุงูุชุทุจูู!
      /// 
      /// ๐ก ููุฒุฉ ุฑุงุฆุนุฉ:
      /// ุฅุฐุง ูุงู ูุฏู ุฌูุฉ ุงูุงุชุตุงู ููุณ ุงูุชุทุจูู ูุซุจุชุ
      /// ููุฏุฑ ูุดูู ูููุนู ุงูุญู ุนูู ุฎุฑูุทุฉ ูุจุงุดุฑุฉ ูู ุงูุชุทุจูู!
      fcmToken: fields[5] as String?,
      
      /// Field 6: ููุน ุงูุนูุงูุฉ
      /// - ูุตู ุงูุนูุงูุฉ ุจูู ุงููุณุชุฎุฏู ูุฌูุฉ ุงูุงุชุตุงู
      /// - ุฃูุซูุฉ:
      ///   * "ูุงูุฏ"
      ///   * "ุฃุฎ"
      ///   * "ุตุฏูู"
      ///   * "ุฒููู ุนูู"
      ///   * "ุดุฑุทุฉ"
      ///   * "ุฅุณุนุงู"
      /// 
      /// ๐ก ูุงุฆุฏุชู:
      /// - ุนุฑุถ ููุธู ูู ุงููุงุฆูุฉ (ุชุฌููุน ุญุณุจ ุงูุนูุงูุฉ)
      /// - ูู ุฑุณุงูุฉ ุงูุงุณุชุบุงุซุฉ: "ูุงูุฏู ูุญูุฏ ุชููู ุชูุจูู ุทูุงุฑุฆ ููู"
      relationship: fields[6] as String,
      
      /// Field 7: ูู ูู contact ุทูุงุฑุฆุ
      /// - true = ูุชู ุงูุงุชุตุงู ุจู ุชููุงุฆูุงู ูู ุญุงูุฉ SOS
      /// - false = contact ุนุงุฏูุ ููุงุทูุงุน ููุท
      /// 
      /// ๐ก ูุซุงู:
      /// - ูุงูุฏู: isEmergencyContact = true
      /// - ุฒููู ุงูุนูู: isEmergencyContact = false
      /// 
      /// โ๏ธ ูุตูุญุฉ ุฃูููุฉ:
      /// ุงุทูุจ ูู ุงููุณุชุฎุฏู ุงุฎุชูุงุฑ 2-5 ุฌูุงุช ุทูุงุฑุฆ ููุท
      /// (ูุง ุชุฒุนุฌ ุงูุฌููุน ูู ูู ูุฑุฉ!)
      isEmergencyContact: fields[7] as bool,
      
      /// Field 8: ุงูุฃููููุฉ
      /// - ุฑูู ูู 1 (ุงูุฃุนูู) ุฅูู 10 (ุงูุฃุฏูู)
      /// - ูุญุฏุฏ ุชุฑุชูุจ ุงูุงุชุตุงู ูู ุญุงูุฉ ุงูุทูุงุฑุฆ
      /// 
      /// ๐ก ูุซุงู ุณููุงุฑูู SOS:
      /// 1. ูุชุตู ุจู priority = 1 (ุงููุงูุฏ) ุฃููุงู
      /// 2. ุจุนุฏ 30 ุซุงููุฉุ ูุชุตู ุจู priority = 2 (ุงูุฃุฎ)
      /// 3. ุจุนุฏ ุฏูููุฉุ ูุชุตู ุจู priority = 3 (ุงูุตุฏูู)
      /// 
      /// ูุฐุง ูููุน "spam" ุงูุฌููุน ูู ููุณ ุงููุญุธุฉ
      priority: fields[8] as int,
      
      /// Field 9: ูู ููุฏุฑ ูุดูู ุงููููุน ุงูุญูุ
      /// - true = ููุฏุฑ ูุชุชุจุน ูููุนู ูุจุงุดุฑุฉ ุฃุซูุงุก ุงูุฑุญูุฉ
      /// - false = ูุดูู ุงููููุน ููุท ูู ุญุงูุฉ ุงูุทูุงุฑุฆ
      /// 
      /// ๐ ุฎุตูุตูุฉ ูููุฉ:
      /// ูุฐุง ุงูุฅุนุฏุงุฏ ุญุณุงุณ! ุจุนุถ ุงููุณุชุฎุฏููู ูุง ูุญุจูู
      /// ุฃู ูุชู ุชุชุจุนูู ุญุชู ูู ูุจู ุงูุนุงุฆูุฉ.
      /// 
      /// ๐ก ุญุงูุงุช ุงูุงุณุชุฎุฏุงู:
      /// - ุงููุงูุฏูู: ุนุงุฏุฉ true (ููุงุทูุฆูุงู)
      /// - ุงูุฃุตุฏูุงุก: ุนุงุฏุฉ false (ุงุญุชุฑุงู ุงูุฎุตูุตูุฉ)
      /// - ุงูุฃุทูุงู: ุฏุงุฆูุงู true (ุฃูุงู ุงูุฃุทูุงู)
      canViewLiveLocation: fields[9] as bool,
      
      /// Field 10: ูู ุชู ุงูุชุญูู ูู ุงูุฑููุ
      /// - true = ุชู ุฅุฑุณุงู ุฑูุฒ ุชุญูู ูุงูุดุฎุต ุฃูุฏู
      /// - false = ูู ูุชู ุงูุชุญูู ุจุนุฏ
      /// 
      /// ๐ก ููุงุฐุง ุงูุชุญูู ูููุ
      /// - ูุชุฃูุฏ ุฃู ุงูุฑูู ุตุญูุญ ูุดุบุงู
      /// - ูุชุฃูุฏ ุฃู ุงูุดุฎุต ููุงูู ุนูู ุงุณุชูุจุงู ุงูุฅุดุนุงุฑุงุช
      /// - ูููุน ุฅุถุงูุฉ ุฃุฑูุงู ุนุดูุงุฆูุฉ
      /// 
      /// ๐ ุทุฑููุฉ ุงูุชุญูู:
      /// 1. ุงููุณุชุฎุฏู ูุฏุฎู ุฑูู ุฌูุฉ ุงูุงุชุตุงู
      /// 2. ูุฑุณู SMS ููู ุฑูุฒ (ูุซูุงู: 123456)
      /// 3. ุฌูุฉ ุงูุงุชุตุงู ุชุฏุฎู ุงูุฑูุฒ ูู ุงูุชุทุจูู ุฃู ุชุคูุฏ ุนุจุฑ ุฑุงุจุท
      /// 4. ูุนููู isVerified = true
      isVerified: fields[10] as bool,
      
      /// Field 11: ุชุงุฑูุฎ ุงูุฅุถุงูุฉ
      /// - ูุชู ุชู ุฅุถุงูุฉ ูุฐู ุงูุฌูุฉุ
      /// - ูุญููุธ ูู Stringุ ูุญููู ูู DateTime
      /// 
      /// ๐ก ูุงุฆุฏุชู:
      /// - ุชุฑุชูุจ ุฌูุงุช ุงูุงุชุตุงู ุญุณุจ ุงูุฃุญุฏุซ
      /// - ุญุฐู ุฌูุงุช ุงูุงุชุตุงู ุงููุฏููุฉ ุบูุฑ ุงููุณุชุฎุฏูุฉ
      /// - ุฅุญุตุงุฆูุงุช: ูุชู ุฃุถุงู ุงููุณุชุฎุฏู ุฃูุซุฑ ุฌูุงุช ุงุชุตุงูุ
      createdAt: DateTime.parse(fields[11] as String),
    );
  }

  /// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  /// ๐พ write() - ุญูุธ ContactModel ูู Hive
  /// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
  /// 
  /// ๐ฏ ูุชู ุชูุณุชุฏุนูุ
  /// - ุนูุฏ ุฅุถุงูุฉ ุฌูุฉ ุงุชุตุงู ุฌุฏูุฏุฉ
  /// - ุนูุฏ ุชุนุฏูู ูุนูููุงุช ุฌูุฉ ุงุชุตุงู (ูุซูุงู ุชุบููุฑ ุงูุฑูู)
  /// - ุนูุฏ ุงูุชุญูู ูู ุฑูู ุฌูุฉ ุงุชุตุงู (isVerified โ true)
  /// - ุนูุฏ ุชุบููุฑ ุงูุตูุงุญูุงุช (canViewLiveLocation)
  /// 
  /// ๐ ุงูุฎุทูุงุช:
  /// 1. ูุชุงุจุฉ ุนุฏุฏ ุงูุญููู (12)
  /// 2. ูุชุงุจุฉ ูู ุญูู ุจุงูุชุฑุชูุจ
  /// 
  /// โ๏ธ ุฃูุงู ููู:
  /// ContactModel ูุญุชูู ุนูู ุจูุงูุงุช ุญุณุงุณุฉ (ุฃุฑูุงูุ ุฅููููุงุช)
  /// Hive ุจุดูู ุงูุชุฑุงุถู ูุง ุชุดูุฑ ุงูุจูุงูุงุช!
  /// 
  /// ๐ก ุญู ุฃููู:
  /// ููููู ุชูุนูู ุงูุชุดููุฑ ูู Hive:
  /// ```dart
  /// await Hive.openBox('contacts', 
  ///   encryptionCipher: HiveAesCipher(encryptionKey)
  /// );
  /// ```
  @override
  void write(BinaryWriter writer, ContactModel obj) {
    writer
      /// 1๏ธโฃ ููุชุจ ุนุฏุฏ ุงูุญููู (12 ุญูู)
      ..writeByte(12)
      
      /// 2๏ธโฃ Field 0: ุงููุนุฑูู
      ..writeByte(0)
      ..write(obj.id)
      
      /// 3๏ธโฃ Field 1: ูุนุฑูู ุงููุณุชุฎุฏู
      ..writeByte(1)
      ..write(obj.userId)
      
      /// 4๏ธโฃ Field 2: ุงูุงุณู
      ..writeByte(2)
      ..write(obj.name)
      
      /// 5๏ธโฃ Field 3: ุฑูู ุงููุงุชู
      /// ๐ ุจูุงูุงุช ุญุณุงุณุฉ!
      ..writeByte(3)
      ..write(obj.phoneNumber)
      
      /// 6๏ธโฃ Field 4: ุงูุจุฑูุฏ ุงูุฅููุชุฑููู (ุงุฎุชูุงุฑู)
      /// ๐ ุจูุงูุงุช ุญุณุงุณุฉ!
      ..writeByte(4)
      ..write(obj.email)
      
      /// 7๏ธโฃ Field 5: FCM Token (ุงุฎุชูุงุฑู)
      ..writeByte(5)
      ..write(obj.fcmToken)
      
      /// 8๏ธโฃ Field 6: ููุน ุงูุนูุงูุฉ
      ..writeByte(6)
      ..write(obj.relationship)
      
      /// 9๏ธโฃ Field 7: ูู contact ุทูุงุฑุฆุ
      ..writeByte(7)
      ..write(obj.isEmergencyContact)
      
      /// ๐ Field 8: ุงูุฃููููุฉ
      ..writeByte(8)
      ..write(obj.priority)
      
      /// 1๏ธโฃ1๏ธโฃ Field 9: ุตูุงุญูุฉ ุฑุคูุฉ ุงููููุน ุงูุญู
      ..writeByte(9)
      ..write(obj.canViewLiveLocation)
      
      /// 1๏ธโฃ2๏ธโฃ Field 10: ุญุงูุฉ ุงูุชุญูู
      ..writeByte(10)
      ..write(obj.isVerified)
      
      /// 1๏ธโฃ3๏ธโฃ Field 11: ุชุงุฑูุฎ ุงูุฅุถุงูุฉ
      /// DateTime โ ISO 8601 String
      ..writeByte(11)
      ..write(obj.createdAt.toIso8601String());
  }
}

/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
/// ๐ ูุนูููุงุช ุชุนููููุฉ ูุณููุงุฑูููุงุช ุนูููุฉ:
/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
/// 
/// ๐ฑ ุณููุงุฑูู ูุงูู - ุฅุถุงูุฉ ุฌูุฉ ุงุชุตุงู ุทูุงุฑุฆ:
/// 
/// ```dart
/// // ุฎุทูุฉ 1: ุงููุณุชุฎุฏู ูุฏุฎู ุจูุงูุงุช ูุงูุฏู
/// final dadContact = ContactModel(
///   id: 'contact_${DateTime.now().millisecondsSinceEpoch}',
///   userId: currentUser.id,
///   name: 'ูุงูุฏู ูุญูุฏ',
///   phoneNumber: '+966501234567',
///   email: 'dad@example.com',
///   relationship: 'ูุงูุฏ',
///   isEmergencyContact: true,
///   priority: 1,                    // ุงูุฃูู ูู ูุงุฆูุฉ ุงูุทูุงุฑุฆ!
///   canViewLiveLocation: true,      // ููุฏุฑ ูุชุชุจุน ูููุนู
///   isVerified: false,              // ูู ูุชู ุงูุชุญูู ุจุนุฏ
///   createdAt: DateTime.now(),
/// );
/// 
/// // ุฎุทูุฉ 2: ุญูุธ ูู Hive (Adapter ูุดุชุบู ููุง!)
/// await contactBox.put(dadContact.id, dadContact);
/// 
/// // ุฎุทูุฉ 3: ุฅุฑุณุงู ุฑูุฒ ุชุญูู ุนุจุฑ SMS
/// final verificationCode = generateRandomCode(); // ูุซูุงู: 123456
/// await sendSMS(dadContact.phoneNumber, 
///   'ุฑูุฒ ุงูุชุญูู ูู ุชุทุจูู PSGA: $verificationCode');
/// 
/// // ุฎุทูุฉ 4: ุงููุงูุฏ ูุฏุฎู ุงูุฑูุฒ
/// if (enteredCode == verificationCode) {
///   // ูุญุฏูุซ Contact
///   final verifiedContact = dadContact.copyWith(isVerified: true);
///   await contactBox.put(dadContact.id, verifiedContact);
///   
///   showSuccess('ุชู ุงูุชุญูู ูู ุฑูู ูุงูุฏู ุจูุฌุงุญ! โ');
/// }
/// ```
/// 
/// ๐จ ุณููุงุฑูู SOS - ุงูุงุณุชุฌุงุจุฉ ููุทูุงุฑุฆ:
/// 
/// ```dart
/// // ุงููุณุชุฎุฏู ูุถุบุท ุฒุฑ SOS ุงููุจูุฑ ุงูุฃุญูุฑ! ๐ด
/// 
/// async function handleSOSPressed() {
///   // 1. ุฌูุจ ุฌููุน ุฌูุงุช ุงูุงุชุตุงู ุงูุทุงุฑุฆุฉ
///   final emergencyContacts = contactBox.values
///       .where((c) => c.isEmergencyContact && c.isVerified)
///       .toList();
///   
///   // 2. ุชุฑุชูุจูู ุญุณุจ ุงูุฃููููุฉ
///   emergencyContacts.sort((a, b) => a.priority.compareTo(b.priority));
///   
///   // 3. ุฅูุดุงุก ุฑุณุงูุฉ ุงูุงุณุชุบุงุซุฉ
///   final sosMessage = '''
///   ๐จ ุชูุจูู ุทูุงุฑุฆ ูู ${currentUser.name}
///   
///   ุงููููุน ุงูุญุงูู: ${currentLocation.address}
///   ุงูุฑุญูุฉ: ${currentTrip.routeName}
///   ุงูููุช: ${DateTime.now().format('HH:mm')}
///   
///   ุชุชุจุน ุงููููุน ุงูุญู: https://psga.app/track/${currentUser.id}
///   ''';
///   
///   // 4. ุฅุฑุณุงู ููู ุฌูุฉ ุงุชุตุงู ุญุณุจ ุงูุฃููููุฉ
///   for (var i = 0; i < emergencyContacts.length; i++) {
///     final contact = emergencyContacts[i];
///     
///     // ุชุฃุฎูุฑ ุจุณูุท ุจูู ูู ุงุชุตุงู (ูุง ูุฒุนุฌ ุงูุฌููุน ูุฑุฉ ูุญุฏุฉ!)
///     await Future.delayed(Duration(seconds: i * 30));
///     
///     // ุฅุฑุณุงู ุนุจุฑ ุฌููุน ุงููููุงุช ุงููุชุงุญุฉ
///     if (contact.fcmToken != null) {
///       await sendPushNotification(contact.fcmToken, sosMessage);
///     }
///     await sendSMS(contact.phoneNumber, sosMessage);
///     if (contact.email != null) {
///       await sendEmail(contact.email, sosMessage);
///     }
///     
///     // ูู ุญุงูุงุช criticalุ ุงุชุตู ูุงุชููุงู!
///     if (i == 0 && sosLevel == AlertLevel.critical) {
///       await makePhoneCall(contact.phoneNumber);
///     }
///   }
/// }
/// ```
/// 
/// ๐บ๏ธ ููุฒุฉ ุงูุชุชุจุน ุงูุญู (Live Tracking):
/// 
/// ```dart
/// // ุฌูุงุช ุงูุงุชุตุงู ุงููู ุนูุฏูู canViewLiveLocation = true
/// // ููุฏุฑูู ูุดูููู ูููุนู ุงูุญู ุนูู ุฎุฑูุทุฉ
/// 
/// // ูู ุตูุญุฉ "ุงููููุน ุงูุญู":
/// class LiveTrackingPage extends StatefulWidget {
///   final Contact trackedPerson;
///   
///   @override
///   Widget build(BuildContext context) {
///     return StreamBuilder<LocationModel>(
///       // ูุณุชูุจู ุงููููุน ูู 10 ุซูุงูู
///       stream: locationUpdatesStream(trackedPerson.userId),
///       builder: (context, snapshot) {
///         if (!snapshot.hasData) return LoadingIndicator();
///         
///         final location = snapshot.data!;
///         return GoogleMap(
///           initialCameraPosition: CameraPosition(
///             target: LatLng(location.latitude, location.longitude),
///             zoom: 15,
///           ),
///           markers: {
///             Marker(
///               markerId: MarkerId(trackedPerson.id),
///               position: LatLng(location.latitude, location.longitude),
///               infoWindow: InfoWindow(
///                 title: trackedPerson.name,
///                 snippet: 'ุขุฎุฑ ุชุญุฏูุซ: ${location.timestamp.timeAgo()}',
///               ),
///             ),
///           },
///         );
///       },
///     );
///   }
/// }
/// ```
/// 
/// ๐ ููุงุญุธุงุช ุฃูููุฉ ูุฎุตูุตูุฉ:
/// 
/// 1๏ธโฃ **ุชุดููุฑ ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ:**
///    - ุฃุฑูุงู ุงูููุงุชู ูุงูุฅููููุงุช ุญุณุงุณุฉ ุฌุฏุงู
///    - ุงุณุชุฎุฏู HiveAesCipher ูุชุดููุฑ ุตูุฏูู contacts
///    - ูุง ุชุญูุธ ุฃุจุฏุงู ูู plain text ูู logs
/// 
/// 2๏ธโฃ **ุงูุชุญูู ูู ุงูุฃุฑูุงู:**
///    - ูุง ุชุฑุณู ุฅุดุนุงุฑุงุช ูุฃุฑูุงู ุบูุฑ ูุญููุฉ (isVerified = false)
///    - ุฃุนุฏ ุงูุชุญูู ูู 6 ุฃุดูุฑ (ุงูุฃุฑูุงู ุชุชุบูุฑ!)
/// 
/// 3๏ธโฃ **ุงุญุชุฑุงู ุงูุฎุตูุตูุฉ:**
///    - canViewLiveLocation ูุฌุจ ุฃู ูููู ุงุฎุชูุงุฑู ุตุฑูุญ
///    - ุงุดุฑุญ ูููุณุชุฎุฏู ุจุงูุถุจุท ูู ููุฏุฑ ูุดูู ูููุนู
///    - ุฃุถู ุฎูุงุฑ "ุฅููุงู ุงููุดุงุฑูุฉ ูุคูุชุงู"
/// 
/// 4๏ธโฃ **GDPR ูุงูููุงููู:**
///    - ุงุญุตู ุนูู ููุงููุฉ ุตุฑูุญุฉ ูุจู ุญูุธ ุฃู ุจูุงูุงุช
///    - ููุฑ ุฎูุงุฑ "ุญุฐู ุฌููุน ุจูุงูุงุชู"
///    - ุงุดุฑุญ ุณูุงุณุฉ ุงูุฎุตูุตูุฉ ุจูุถูุญ
/// 
/// โ๏ธ ุฃุฎุทุงุก ุดุงุฆุนุฉ:
/// 
/// โ **ุฎุทุฃ 1: ุฅุถุงูุฉ ููุณ ุงูุดุฎุต ูุฑุชูู**
/// ```dart
/// // ุชุญูู ูุจู ุงูุฅุถุงูุฉ:
/// final exists = contactBox.values.any((c) => c.phoneNumber == newNumber);
/// if (exists) {
///   showError('ูุฐู ุงูุฌูุฉ ููุฌูุฏุฉ ุจุงููุนู!');
///   return;
/// }
/// ```
/// 
/// โ **ุฎุทุฃ 2: ูุณูุงู ุงูุชุญูู ูู isVerified**
/// ```dart
/// // ูุง ุชุฑุณู ูุฃุฑูุงู ุบูุฑ ูุญููุฉ!
/// if (!contact.isVerified) {
///   showWarning('ูุฑุฌู ุงูุชุญูู ูู ุฑูู ${contact.name} ุฃููุงู');
///   return;
/// }
/// ```
/// 
/// โ **ุฎุทุฃ 3: ุฅุฒุนุงุฌ ุฌูุงุช ุงูุงุชุตุงู ุจูุซุฑุฉ**
/// ```dart
/// // ุฃุถู cooldown period:
/// final lastSOSTime = await getLastSOSTime(contact.id);
/// if (DateTime.now().difference(lastSOSTime).inMinutes < 5) {
///   // ูุง ุชุฑุณู! ุฃุฑุณููุง ูู ูุจู ุฃูู ูู 5 ุฏูุงุฆู
///   return;
/// }
/// ```
/// 
/// ๐ก ูุตุงุฆุญ ุงุญุชุฑุงููุฉ:
/// 
/// 1. **Smart Priorities**: ุฑุชุจ ุฌูุงุช ุงูุงุชุตุงู ุชููุงุฆูุงู ุจูุงุกู ุนูู:
///    - ูุฏู ูุฑุจ ุงูุนูุงูุฉ (ูุงูุฏูู = ุฃุนูู ุฃููููุฉ)
///    - ูุนุฏู ุงูุงุณุชุฌุงุจุฉ (ูู ูุฑุฏ ุฃุณุฑุนุ)
///    - ุงูุชููุฑ (ูู ูููู online ุนุงุฏุฉ ูู ูุฐุง ุงูููุชุ)
/// 
/// 2. **Verify Contact Details**: ุฃุฑุณู ุชุฐููุฑ ูู 3-6 ุฃุดูุฑ:
///    "ูู ุฑูู ูุงูุฏู ูุง ูุฒุงู +966501234567ุ"
/// 
/// 3. **Backup Contacts**: ุงุทูุจ ูู ุงููุณุชุฎุฏู ุฅุถุงูุฉ 3-5 ุฌูุงุช ุนูู ุงูุฃูู
///    (ูู ูุงุญุฏ ูุง ุฑุฏุ ุนูุฏูุง ุจุฏุงุฆู!)
/// 
/// 4. **Analytics**: ุชุชุจุน:
///    - ูู ูุฑุฉ ุชู ุงุณุชุฎุฏุงู ูู ุฌูุฉ ุงุชุตุงูุ
///    - ูุง ูู ูุนุฏู ุงูุงุณุชุฌุงุจุฉุ
///    - ุฃู ุฌูุงุช ูู ุชุณุชุฌุจ ุฃุจุฏุงูุ (ุฑุจูุง ุงูุฑูู ุฎุทุฃ)
/// โโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโโ
